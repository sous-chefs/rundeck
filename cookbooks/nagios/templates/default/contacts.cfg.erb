# Contact definitions
#
# Autogenerated by Chef.

define contact {
  contact_name                    root
  alias                           Root
  service_notification_period     24x7
  host_notification_period        24x7
  service_notification_options    w,u,c,r
  host_notification_options       d,r
  service_notification_commands   service-notify-by-email
  host_notification_commands      host-notify-by-email
  email                           root@localhost
}

define contactgroup {
  contactgroup_name admins
  alias             Nagios Administrators
  members           <%= @members.join(',') %><%= ",pagerduty" unless node['nagios']['pagerduty_key'].empty? %>
}

define contactgroup {
  contactgroup_name admins-sms
  alias             Sysadmin SMS
  members           <%= @members.join(',') %>
}

<% @admins.each do |a| -%>
define contact {
  use          default-contact
  contact_name <%= a['id'] %>
  <%= "email  #{a['nagios']['email']}" unless a['nagios'].nil? || a['nagios']['email'].nil? %>
}

<% end -%>

<% @contacts.each do |c| -%>
  <% if c['contact_group'] == true -%>
define contact_group {
  contactgroup_name  <%= c['id'] %>
  <% if c['alias'] -%>alias <%= c['alias'] %><% end -%>
  members
}
 <% else -%>
define contact {
  contact_name  <%= c['id'] %>
  use <% if c['contact_template'].nil? -%>default-contact<% else -%><%= c['contact_template'] %> <% end -%>
  <% %w{ alias host_notifications_enabled service_notifications_enabled service_notification_period host_notification_period service_notification_options host_notification_options service_notification_commands host_notification_commands email pager address1 address2 can_submit_commands }.each do |object| %>
    <% unless c[object].nil? %>
  <%= object %> <%= c[object] %>
    <% end %>
}
 <% end -%>
<% end -%>